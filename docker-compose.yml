version: "2"
volumes: 
  resin-data:
services:
  mongodb:
    image: mongo:4.2
    restart: always
    network_mode: 'host'
    volumes: 
      - 'resin-data:/data'
  nuster-turbine:
    build: ./
    network_mode: "host"
    depends_on: 
      - "mongodb"
    volumes:
      - "resin-data:/data"
    environment:
      DISABLE_AUTH: 'true'
  nuster-desktop:
    build: ./nuster-desktop/
    restart: always
    network_mode: host
    depends_on: 
      - "nuster-turbine"
      - "mongodb"
  nuster-kiosk:
    image: balenablocks/browser:latest
    privileged: true # required for UDEV to find plugged in peripherals such as a USB mouse
    network_mode: host
    depends_on:
      - 'nuster-desktop'
    environment:
      LAUNCH_URL: 'http://127.0.0.1:3000/app'
      KIOSK: 1
      ENABLE_GPU: 1
      ROTATE_DISPLAY: 'right'
      TOUCHSCREEN: 'wch Touch'
      WINDOW_SIZE: 600, 1024